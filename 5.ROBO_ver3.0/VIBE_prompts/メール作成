E.create_email.py
Ea.create_excel_PDF.py
Eb.write_email.py
Ec.show_mail_and_PDF.py
を作りたい。これは、A. B.の流れにくっつけてください。A. B. C. D.の後に実行されるはずです。(今はc. D.はありません)
________________________________________
Ea.create_excel_PDF.py
まず、"C:\Users\E375411\Desktop\【全社標準】弔事対応フォルダ\2. RPAブック\"このフォルダーの"RPAブック.xlsx"以外のファイルを削除してほしい。

そして、RPAブックの"弔事連絡票"という名前のシートを、PDFとして保存してほしい。保存する場所は"C:\Users\E375411\Desktop\【全社標準】弔事対応フォルダ\2. RPAブック\"
ここで、PDFのファイル名は"RPAシート"のD13のセルに書いてある文字列を設定してほしい。

そして、同じく、RPAブックの"弔事連絡票"という名前のシートを、今度は新しいエクセルファイルとして保存してほしい。保存する場所は"C:\Users\E375411\Desktop\【全社標準】弔事対応フォルダ\2. RPAブック\"
ここで、エクセルのファイル名は"RPAシート"のD13のセルに書いてある文字列を設定してほしい。

________________________________________
Eb.write_email.py
ここでは、メールを作成します。
アウトルックから、新規メールの下書きを作成し、

宛先は"RPAシート"のD3のセルの文字列
件名は"RPAシート"のD12のセルの文字列
添付ファイルは、先ほど、Ea.create_excel_PDF.pyで、"C:\Users\E375411\Desktop\【全社標準】弔事対応フォルダ\2. RPAブック\"
　　ここに保存した、PDFファイルを。
㏄には"RPAシート"のD25のセルの文字列
bccには"RPAシート"のD26のセルの文字列
本文には"RPAシート"のD27のセルの文字列
を記入してください。絶対に送らないでください。おくるのは手動でやります。

________________________________________
Ec.show_mail_and_PDF.py

そしたら、最後に、メールの本文を画面の左側に開いて、
添付のPDFファイルを画面の右側に開いてほしいです。
そしたら、一番手前に、フォント14で、
"メール作成が完了しました！内容に間違いがなければ手動でメールの送信を行ってください。
添付ファイルを変更したい場合は”PDF変更”のボタンを押してください"
というポップアップを出し、ボタンを二つ用意してください"次に進む"というボタンと"PDF変更"のボタンを作ってください

次に進む場合はEc.show_mail_and_PDF.pyを終わらせて、Ed.に進んでください
"PDF変更"の場合は、RPAブックの"弔事連絡票"シートを開いて表示させてください。
表示させたら、"内容を修正してください"とフォント１４でポップアップを出してほしいです。
"次に進む"というボタンだけ用意して、押されるのを待機してください。押されたら、
Ea.create_excel_PDF.pyの関数から、もう一度実行してください。

________________________________________
Ed.error_log
エラーログを作りたいです。
"C:\Users\E375411\Panasonic\TM.PHR_HR-PRIDEメンバー - 標準化\3. 過去のデータ\error_log.xlsx"
ここのエクセルファイルの一番最初の空行に対して

実行開始日時(A列)
終了日時(B列)
かかった時間(C列)
管理No(D列)
ユーザー番号(E列)
最後まで通ったか(F列)
エラー内容(G列)
FB/コメント(H列)

を埋めたいです。
実行開始日時(A列)は、Aa.create_initial_fromが入力され終わって、完了を押された瞬間の時間
終了日時(B列)は、今の時間
かかった時間(C列)は、今の時間(終了日時)から、実行開始日時を引いた値
管理No(D列)は、Aa.create_initial_fromで入力された、値。
ユーザー番号(E列)PCの個体別につけられている番号。このPCだったら、E380821になるはず。
最後まで通ったか(F列)、プログラムがエラーを出さずに、ここまでこれたか、通ったら"〇"通らないで、プログラムがエラーで終了したらここに"✕"を入力してください
エラー内容(G列)、もし、プログラムがエラーで終了していたら、こちのエクセルブックになぜエラーで終わったか、わかりやすいように、エラーメッセージをこの欄に入力してください。
FB/コメント(H列)、もし、プログラムがエラーを出さずに、ここまで来たら、最後に"ロボに対してFB/コメント等があれば教えてください"というポップアップを出し、自由記述200文字程度の記述欄と、"確定"ボタンを作ってください、入力必須ではありません。

この内容を、埋めてください。

________________________________________

Ee.kakunou.py
もしここまでエラーなしできたら、
"今回の弔事連絡票(PDFファイル)を指定場所に格納しますか?"と聞いて、
"はい"だと以下のことをしてください。"いいえ"だったら、そのままEf.に進んでください。

"はい"の場合
Ea.create_excel_PDF.pyで今回作成した、PDFとエクセルファイルを該当するフォルダーにコピーします。
フォルダーの場所は
"C:\Users\E375411\Panasonic\TM.PHR_集中化 - General\%company_name%弔事関連\99_ロボ弔事格納"%company_name%は変数！
に入れてほしいです。
そしたら次に進んでください
________________________________________
Ee.last_dialog.py

もし、プログラムがエラーで終了したら、必ず、

フォント18で"申し訳ありません、ロボはエラーで終わりました。"
というタイトルで、
フォント12で、"以下がエラー内容です"
その下にフォント12で、エラー内容を書いてほしいです。
"OK"ボタンだけつくって、押されたらプログラムを終了してください。


もしここまで来て、プログラムが正常に動作していたら、

フォント24(かわいいフォントで)"手配が完了ました！"
というタイトルで、
フォント16で、"ロボをご利用ありがとうございました。"
その下にフォント12で、エラー内容を書いてほしいです。
"OK"ボタンだけつくって、押されたらプログラムを終了してください。
________________________________________

最後に、このプログラムはいろんなPCで利用したいので、
"C:\Users\E375411\Panasonic\"
こういった、ユーザーのフォルダーはパソコンそれぞれ任意になるようにしてください！
どのユーザーでも動くようにして！